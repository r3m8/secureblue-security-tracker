{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  scsi: iscsi: iscsi_tcp: Fix null-ptr-deref while calling getpeername()  Fix a NULL pointer crash that occurs when we are freeing the socket at the same time we access it via sysfs.  The problem is that:   1. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() take     the frwd_lock and do sock_hold() then drop the frwd_lock. sock_hold()     does a get on the \"struct sock\".   2. iscsi_sw_tcp_release_conn() does sockfd_put() which does the last put     on the \"struct socket\" and that does __sock_release() which sets the     sock->ops to NULL.   3. iscsi_sw_tcp_conn_get_param() and iscsi_sw_tcp_host_get_param() then     call kernel_getpeername() which accesses the NULL sock->ops.  Above we do a get on the \"struct sock\", but we needed a get on the \"struct socket\". Originally, we just held the frwd_lock the entire time but in commit bcf3a2953d36 (\"scsi: iscsi: iscsi_tcp: Avoid holding spinlock while calling getpeername()\") we switched to refcount based because the network layer changed and started taking a mutex in that path, so we could no longer hold the frwd_lock.  Instead of trying to maintain multiple refcounts, this just has us use a mutex for accessing the socket in the interface code paths.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.0.3-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.158-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.0.3-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.0.3-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.0.3-1",
      "urgency": "not yet assigned"
    }
  }
}