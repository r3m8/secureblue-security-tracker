{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  rcu: Fix rcu_read_unlock() deadloop due to IRQ work  During rcu_read_unlock_special(), if this happens during irq_exit(), we can lockup if an IPI is issued. This is because the IPI itself triggers the irq_exit() path causing a recursive lock up.  This is precisely what Xiongfeng found when invoking a BPF program on the trace_tick_stop() tracepoint As shown in the trace below. Fix by managing the irq_work state correctly.  irq_exit()   __irq_exit_rcu()     /* in_hardirq() returns false after this */     preempt_count_sub(HARDIRQ_OFFSET)     tick_irq_exit()       tick_nohz_irq_exit() \t    tick_nohz_stop_sched_tick() \t      trace_tick_stop()  /* a bpf prog is hooked on this trace point */ \t\t   __bpf_trace_tick_stop() \t\t      bpf_trace_run2() \t\t\t    rcu_read_unlock_special()                               /* will send a IPI to itself */ \t\t\t      irq_work_queue_on(&rdp->defer_qs_iw, rdp->cpu);  A simple reproducer can also be obtained by doing the following in tick_irq_exit(). It will hang on boot without the patch:    static inline void tick_irq_exit(void)   {  +\trcu_read_lock();  +\tWRITE_ONCE(current->rcu_read_unlock_special.b.need_qs, true);  +\trcu_read_unlock();  +  [neeraj: Apply Frederic's suggested fix for PREEMPT_RT]",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "open",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "open",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.16.3-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.16.3-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.12.43-1",
      "urgency": "not yet assigned"
    }
  }
}