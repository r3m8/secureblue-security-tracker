{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  powerpc/papr_scm: don't requests stats with '0' sized stats buffer  Sachin reported [1] that on a POWER-10 lpar he is seeing a kernel panic being reported with vPMEM when papr_scm probe is being called. The panic is of the form below and is observed only with following option disabled(profile) for the said LPAR 'Enable Performance Information Collection' in the HMC:   Kernel attempted to write user page (1c) - exploit attempt? (uid: 0)  BUG: Kernel NULL pointer dereference on write at 0x0000001c  Faulting instruction address: 0xc008000001b90844  Oops: Kernel access of bad area, sig: 11 [#1] <snip>  NIP [c008000001b90844] drc_pmem_query_stats+0x5c/0x270 [papr_scm]  LR [c008000001b92794] papr_scm_probe+0x2ac/0x6ec [papr_scm]  Call Trace:        0xc00000000941bca0 (unreliable)        papr_scm_probe+0x2ac/0x6ec [papr_scm]        platform_probe+0x98/0x150        really_probe+0xfc/0x510        __driver_probe_device+0x17c/0x230 <snip>  ---[ end trace 0000000000000000 ]---  Kernel panic - not syncing: Fatal exception  On investigation looks like this panic was caused due to a 'stat_buffer' of size==0 being provided to drc_pmem_query_stats() to fetch all performance stats-ids of an NVDIMM. However drc_pmem_query_stats() shouldn't have been called since the vPMEM NVDIMM doesn't support and performance stat-id's. This was caused due to missing check for 'p->stat_buffer_len' at the beginning of papr_scm_pmu_check_events() which indicates that the NVDIMM doesn't support performance-stats.  Fix this by introducing the check for 'p->stat_buffer_len' at the beginning of papr_scm_pmu_check_events().  [1] https://lore.kernel.org/all/6B3A522A-6A5F-4CC9-B268-0C63AA6E07D3@linux.ibm.com",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    }
  }
}