{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  net/mlx5: fs, fix UAF in flow counter release  Fix a kernel trace [1] caused by releasing an HWS action of a local flow counter in mlx5_cmd_hws_delete_fte(), where the HWS action refcount and mutex were not initialized and the counter struct could already be freed when deleting the rule.  Fix it by adding the missing initializations and adding refcount for the local flow counter struct.  [1] Kernel log:  Call Trace:   <TASK>   dump_stack_lvl+0x34/0x48   mlx5_fs_put_hws_action.part.0.cold+0x21/0x94 [mlx5_core]   mlx5_fc_put_hws_action+0x96/0xad [mlx5_core]   mlx5_fs_destroy_fs_actions+0x8b/0x152 [mlx5_core]   mlx5_cmd_hws_delete_fte+0x5a/0xa0 [mlx5_core]   del_hw_fte+0x1ce/0x260 [mlx5_core]   mlx5_del_flow_rules+0x12d/0x240 [mlx5_core]   ? ttwu_queue_wakelist+0xf4/0x110   mlx5_ib_destroy_flow+0x103/0x1b0 [mlx5_ib]   uverbs_free_flow+0x20/0x50 [ib_uverbs]   destroy_hw_idr_uobject+0x1b/0x50 [ib_uverbs]   uverbs_destroy_uobject+0x34/0x1a0 [ib_uverbs]   uobj_destroy+0x3c/0x80 [ib_uverbs]   ib_uverbs_run_method+0x23e/0x360 [ib_uverbs]   ? uverbs_finalize_object+0x60/0x60 [ib_uverbs]   ib_uverbs_cmd_verbs+0x14f/0x2c0 [ib_uverbs]   ? do_tty_write+0x1a9/0x270   ? file_tty_write.constprop.0+0x98/0xc0   ? new_sync_write+0xfc/0x190   ib_uverbs_ioctl+0xd7/0x160 [ib_uverbs]   __x64_sys_ioctl+0x87/0xc0   do_syscall_64+0x59/0x90",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.16.10-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.16.10-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    }
  }
}