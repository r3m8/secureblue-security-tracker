{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  cgroup,freezer: hold cpu_hotplug_lock before freezer_mutex  syzbot is reporting circular locking dependency between cpu_hotplug_lock and freezer_mutex, for commit f5d39b020809 (\"freezer,sched: Rewrite core freezer logic\") replaced atomic_inc() in freezer_apply_state() with static_branch_inc() which holds cpu_hotplug_lock.  cpu_hotplug_lock => cgroup_threadgroup_rwsem => freezer_mutex    cgroup_file_write() {     cgroup_procs_write() {       __cgroup_procs_write() {         cgroup_procs_write_start() {           cgroup_attach_lock() {             cpus_read_lock() {               percpu_down_read(&cpu_hotplug_lock);             }             percpu_down_write(&cgroup_threadgroup_rwsem);           }         }         cgroup_attach_task() {           cgroup_migrate() {             cgroup_migrate_execute() {               freezer_attach() {                 mutex_lock(&freezer_mutex);                 (...snipped...)               }             }           }         }         (...snipped...)       }     }   }  freezer_mutex => cpu_hotplug_lock    cgroup_file_write() {     freezer_write() {       freezer_change_state() {         mutex_lock(&freezer_mutex);         freezer_apply_state() {           static_branch_inc(&freezer_active) {             static_key_slow_inc() {               cpus_read_lock();               static_key_slow_inc_cpuslocked();               cpus_read_unlock();             }           }         }         mutex_unlock(&freezer_mutex);       }     }   }  Swap locking order by moving cpus_read_lock() in freezer_apply_state() to before mutex_lock(&freezer_mutex) in freezer_change_state().",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.25-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.1.25-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.1.25-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.1.25-1",
      "urgency": "not yet assigned"
    }
  }
}