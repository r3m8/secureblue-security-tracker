{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  netfilter: conntrack: fix wrong ct->timeout value  (struct nf_conn)->timeout is an interval before the conntrack confirmed.  After confirmed, it becomes a timestamp.  It is observed that timeout of an unconfirmed conntrack: - Set by calling ctnetlink_change_timeout(). As a result,   `nfct_time_stamp` was wrongly added to `ct->timeout` twice. - Get by calling ctnetlink_dump_timeout(). As a result,   `nfct_time_stamp` was wrongly subtracted.  Call Trace:  <TASK>  dump_stack_lvl  ctnetlink_dump_timeout  __ctnetlink_glue_build  ctnetlink_glue_build  __nfqnl_enqueue_packet  nf_queue  nf_hook_slow  ip_mc_output  ? __pfx_ip_finish_output  ip_send_skb  ? __pfx_dst_output  udp_send_skb  udp_sendmsg  ? __pfx_ip_generic_getfrag  sock_sendmsg  Separate the 2 cases in: - Setting `ct->timeout` in __nf_ct_set_timeout(). - Getting `ct->timeout` in ctnetlink_dump_timeout().  Pablo appends:  Update ctnetlink to set up the timeout _after_ the IPS_CONFIRMED flag is set on, otherwise conntrack creation via ctnetlink breaks.  Note that the problem described in this patch occurs since the introduction of the nfnetlink_queue conntrack support, select a sufficiently old Fixes: tag for -stable kernel to pick up this fix.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.37-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "open",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    }
  }
}