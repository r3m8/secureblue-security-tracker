{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  KVM: nSVM: Check instead of asserting on nested TSC scaling support  Check for nested TSC scaling support on nested SVM VMRUN instead of asserting that TSC scaling is exposed to L1 if L1's MSR_AMD64_TSC_RATIO has diverged from KVM's default.  Userspace can trigger the WARN at will by writing the MSR and then updating guest CPUID to hide the feature (modifying guest CPUID is allowed anytime before KVM_RUN).  E.g. hacking KVM's state_test selftest to do  \t\tvcpu_set_msr(vcpu, MSR_AMD64_TSC_RATIO, 0); \t\tvcpu_clear_cpuid_feature(vcpu, X86_FEATURE_TSCRATEMSR);  after restoring state in a new VM+vCPU yields an endless supply of:    ------------[ cut here ]------------   WARNING: CPU: 164 PID: 62565 at arch/x86/kvm/svm/nested.c:699            nested_vmcb02_prepare_control+0x3d6/0x3f0 [kvm_amd]   Call Trace:    <TASK>    enter_svm_guest_mode+0x114/0x560 [kvm_amd]    nested_svm_vmrun+0x260/0x330 [kvm_amd]    vmrun_interception+0x29/0x30 [kvm_amd]    svm_invoke_exit_handler+0x35/0x100 [kvm_amd]    svm_handle_exit+0xe7/0x180 [kvm_amd]    kvm_arch_vcpu_ioctl_run+0x1eab/0x2570 [kvm]    kvm_vcpu_ioctl+0x4c9/0x5b0 [kvm]    __se_sys_ioctl+0x7a/0xc0    __x64_sys_ioctl+0x21/0x30    do_syscall_64+0x41/0x90    entry_SYSCALL_64_after_hwframe+0x63/0xcd   RIP: 0033:0x45ca1b  Note, the nested #VMEXIT path has the same flaw, but needs a different fix and will be handled separately.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.55-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    }
  }
}