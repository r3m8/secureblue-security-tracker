{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  vxlan: vnifilter: Fix unlocked deletion of default FDB entry  When a VNI is deleted from a VXLAN device in 'vnifilter' mode, the FDB entry associated with the default remote (assuming one was configured) is deleted without holding the hash lock. This is wrong and will result in a warning [1] being generated by the lockdep annotation that was added by commit ebe642067455 (\"vxlan: Create wrappers for FDB lookup\").  Reproducer:   # ip link add vx0 up type vxlan dstport 4789 external vnifilter local 192.0.2.1  # bridge vni add vni 10010 remote 198.51.100.1 dev vx0  # bridge vni del vni 10010 dev vx0  Fix by acquiring the hash lock before the deletion and releasing it afterwards. Blame the original commit that introduced the issue rather than the one that exposed it.  [1] WARNING: CPU: 3 PID: 392 at drivers/net/vxlan/vxlan_core.c:417 vxlan_find_mac+0x17f/0x1a0 [...] RIP: 0010:vxlan_find_mac+0x17f/0x1a0 [...] Call Trace:  <TASK>  __vxlan_fdb_delete+0xbe/0x560  vxlan_vni_delete_group+0x2ba/0x940  vxlan_vni_del.isra.0+0x15f/0x580  vxlan_process_vni_filter+0x38b/0x7b0  vxlan_vnifilter_process+0x3bb/0x510  rtnetlink_rcv_msg+0x2f7/0xb70  netlink_rcv_skb+0x131/0x360  netlink_unicast+0x426/0x710  netlink_sendmsg+0x75a/0xc20  __sock_sendmsg+0xc1/0x150  ____sys_sendmsg+0x5aa/0x7b0  ___sys_sendmsg+0xfc/0x180  __sys_sendmsg+0x121/0x1b0  do_syscall_64+0xbb/0x1d0  entry_SYSCALL_64_after_hwframe+0x4b/0x53",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.140-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "0",
      "urgency": "unimportant"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.12.29-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.12.29-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.12.29-1",
      "urgency": "not yet assigned"
    }
  }
}