{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  blk-crypto: make blk_crypto_evict_key() more robust  If blk_crypto_evict_key() sees that the key is still in-use (due to a bug) or that ->keyslot_evict failed, it currently just returns while leaving the key linked into the keyslot management structures.  However, blk_crypto_evict_key() is only called in contexts such as inode eviction where failure is not an option.  So actually the caller proceeds with freeing the blk_crypto_key regardless of the return value of blk_crypto_evict_key().  These two assumptions don't match, and the result is that there can be a use-after-free in blk_crypto_reprogram_all_keys() after one of these errors occurs.  (Note, these errors *shouldn't* happen; we're just talking about what happens if they do anyway.)  Fix this by making blk_crypto_evict_key() unlink the key from the keyslot management structures even on failure.  Also improve some comments.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.37-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.191-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.3.7-1",
      "urgency": "not yet assigned"
    }
  }
}