{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  sched/fair: Fix fault in reweight_entity  Syzbot found a GPF in reweight_entity. This has been bisected to commit 4ef0c5c6b5ba (\"kernel/sched: Fix sched_fork() access an invalid sched_task_group\")  There\u00a0is a race between sched_post_fork() and setpriority(PRIO_PGRP) within a thread group that causes a null-ptr-deref\u00a0in reweight_entity() in CFS. The scenario is that the main process spawns number of new threads, which then call setpriority(PRIO_PGRP, 0, -20), wait, and exit.  For each of the new threads the copy_process() gets invoked, which adds the new task_struct and calls sched_post_fork() for it.  In the above scenario there is a possibility that setpriority(PRIO_PGRP) and set_one_prio() will be called for a thread in the group that is just being created by copy_process(), and for which the sched_post_fork() has not been executed yet. This will trigger a null pointer dereference in reweight_entity(),\u00a0as it will try to access the run queue pointer, which hasn't been set.  Before the mentioned change the cfs_rq pointer for the task  has been set in sched_fork(), which is called much earlier in copy_process(), before the new task is added to the thread_group.  Now it is done in the sched_post_fork(), which is called after that.  To fix the issue the remove the update_load param from the update_load param() function and call reweight_task() only if the task flag doesn't have the TASK_NEW flag set.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "5.16.14-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.140-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "5.16.14-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "5.16.14-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "5.16.14-1",
      "urgency": "not yet assigned"
    }
  }
}