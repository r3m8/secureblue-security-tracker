{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  mac80211: fix potential double free on mesh join  While commit 6a01afcf8468 (\"mac80211: mesh: Free ie data when leaving mesh\") fixed a memory leak on mesh leave / teardown it introduced a potential memory corruption caused by a double free when rejoining the mesh:    ieee80211_leave_mesh()   -> kfree(sdata->u.mesh.ie);   ...   ieee80211_join_mesh()   -> copy_mesh_setup()      -> old_ie = ifmsh->ie;      -> kfree(old_ie);  This double free / kernel panics can be reproduced by using wpa_supplicant with an encrypted mesh (if set up without encryption via \"iw\" then ifmsh->ie is always NULL, which avoids this issue). And then calling:    $ iw dev mesh0 mesh leave   $ iw dev mesh0 mesh join my-mesh  Note that typically these commands are not used / working when using wpa_supplicant. And it seems that wpa_supplicant or wpa_cli are going through a NETDEV_DOWN/NETDEV_UP cycle between a mesh leave and mesh join where the NETDEV_UP resets the mesh.ie to NULL via a memcpy of default_mesh_setup in cfg80211_netdev_notifier_call, which then avoids the memory corruption, too.  The issue was first observed in an application which was not using wpa_supplicant but \"Senf\" instead, which implements its own calls to nl80211.  Fixing the issue by removing the kfree()'ing of the mesh IE in the mesh join function and leaving it solely up to the mesh leave to free the mesh IE.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "5.17.3-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.113-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "5.17.3-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "5.17.3-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "5.17.3-1",
      "urgency": "not yet assigned"
    }
  }
}