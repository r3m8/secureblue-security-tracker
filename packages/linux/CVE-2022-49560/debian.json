{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  exfat: check if cluster num is valid  Syzbot reported slab-out-of-bounds read in exfat_clear_bitmap. This was triggered by reproducer calling truncute with size 0, which causes the following trace:  BUG: KASAN: slab-out-of-bounds in exfat_clear_bitmap+0x147/0x490 fs/exfat/balloc.c:174 Read of size 8 at addr ffff888115aa9508 by task syz-executor251/365  Call Trace:  __dump_stack lib/dump_stack.c:77 [inline]  dump_stack_lvl+0x1e2/0x24b lib/dump_stack.c:118  print_address_description+0x81/0x3c0 mm/kasan/report.c:233  __kasan_report mm/kasan/report.c:419 [inline]  kasan_report+0x1a4/0x1f0 mm/kasan/report.c:436  __asan_report_load8_noabort+0x14/0x20 mm/kasan/report_generic.c:309  exfat_clear_bitmap+0x147/0x490 fs/exfat/balloc.c:174  exfat_free_cluster+0x25a/0x4a0 fs/exfat/fatent.c:181  __exfat_truncate+0x99e/0xe00 fs/exfat/file.c:217  exfat_truncate+0x11b/0x4f0 fs/exfat/file.c:243  exfat_setattr+0xa03/0xd40 fs/exfat/file.c:339  notify_change+0xb76/0xe10 fs/attr.c:336  do_truncate+0x1ea/0x2d0 fs/open.c:65  Move the is_valid_cluster() helper from fatent.c to a common header to make it reusable in other *.c files. And add is_valid_cluster() to validate if cluster number is within valid range in exfat_clear_bitmap() and exfat_set_bitmap().",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "5.18.2-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.120-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "5.18.2-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "5.18.2-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "5.18.2-1",
      "urgency": "not yet assigned"
    }
  }
}