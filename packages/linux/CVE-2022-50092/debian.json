{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  dm thin: fix use-after-free crash in dm_sm_register_threshold_callback  Fault inject on pool metadata device reports:   BUG: KASAN: use-after-free in dm_pool_register_metadata_threshold+0x40/0x80   Read of size 8 at addr ffff8881b9d50068 by task dmsetup/950    CPU: 7 PID: 950 Comm: dmsetup Tainted: G        W         5.19.0-rc6 #1   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.14.0-1.fc33 04/01/2014   Call Trace:    <TASK>    dump_stack_lvl+0x34/0x44    print_address_description.constprop.0.cold+0xeb/0x3f4    kasan_report.cold+0xe6/0x147    dm_pool_register_metadata_threshold+0x40/0x80    pool_ctr+0xa0a/0x1150    dm_table_add_target+0x2c8/0x640    table_load+0x1fd/0x430    ctl_ioctl+0x2c4/0x5a0    dm_ctl_ioctl+0xa/0x10    __x64_sys_ioctl+0xb3/0xd0    do_syscall_64+0x35/0x80    entry_SYSCALL_64_after_hwframe+0x46/0xb0  This can be easily reproduced using:   echo offline > /sys/block/sda/device/state   dd if=/dev/zero of=/dev/mapper/thin bs=4k count=10   dmsetup load pool --table \"0 20971520 thin-pool /dev/sda /dev/sdb 128 0 0\"  If a metadata commit fails, the transaction will be aborted and the metadata space maps will be destroyed. If a DM table reload then happens for this failed thin-pool, a use-after-free will occur in dm_sm_register_threshold_callback (called from dm_pool_register_metadata_threshold).  Fix this by in dm_pool_register_metadata_threshold() by returning the -EINVAL error if the thin-pool is in fail mode. Also fail pool_ctr() with a new error message: \"Error registering metadata threshold\".",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.0.2-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.140-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.0.2-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.0.2-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.0.2-1",
      "urgency": "not yet assigned"
    }
  }
}