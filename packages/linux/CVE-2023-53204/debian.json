{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  af_unix: Fix data-races around user->unix_inflight.  user->unix_inflight is changed under spin_lock(unix_gc_lock), but too_many_unix_fds() reads it locklessly.  Let's annotate the write/read accesses to user->unix_inflight.  BUG: KCSAN: data-race in unix_attach_fds / unix_inflight  write to 0xffffffff8546f2d0 of 8 bytes by task 44798 on cpu 1:  unix_inflight+0x157/0x180 net/unix/scm.c:66  unix_attach_fds+0x147/0x1e0 net/unix/scm.c:123  unix_scm_to_skb net/unix/af_unix.c:1827 [inline]  unix_dgram_sendmsg+0x46a/0x14f0 net/unix/af_unix.c:1950  unix_seqpacket_sendmsg net/unix/af_unix.c:2308 [inline]  unix_seqpacket_sendmsg+0xba/0x130 net/unix/af_unix.c:2292  sock_sendmsg_nosec net/socket.c:725 [inline]  sock_sendmsg+0x148/0x160 net/socket.c:748  ____sys_sendmsg+0x4e4/0x610 net/socket.c:2494  ___sys_sendmsg+0xc6/0x140 net/socket.c:2548  __sys_sendmsg+0x94/0x140 net/socket.c:2577  __do_sys_sendmsg net/socket.c:2586 [inline]  __se_sys_sendmsg net/socket.c:2584 [inline]  __x64_sys_sendmsg+0x45/0x50 net/socket.c:2584  do_syscall_x64 arch/x86/entry/common.c:50 [inline]  do_syscall_64+0x3b/0x90 arch/x86/entry/common.c:80  entry_SYSCALL_64_after_hwframe+0x6e/0xd8  read to 0xffffffff8546f2d0 of 8 bytes by task 44814 on cpu 0:  too_many_unix_fds net/unix/scm.c:101 [inline]  unix_attach_fds+0x54/0x1e0 net/unix/scm.c:110  unix_scm_to_skb net/unix/af_unix.c:1827 [inline]  unix_dgram_sendmsg+0x46a/0x14f0 net/unix/af_unix.c:1950  unix_seqpacket_sendmsg net/unix/af_unix.c:2308 [inline]  unix_seqpacket_sendmsg+0xba/0x130 net/unix/af_unix.c:2292  sock_sendmsg_nosec net/socket.c:725 [inline]  sock_sendmsg+0x148/0x160 net/socket.c:748  ____sys_sendmsg+0x4e4/0x610 net/socket.c:2494  ___sys_sendmsg+0xc6/0x140 net/socket.c:2548  __sys_sendmsg+0x94/0x140 net/socket.c:2577  __do_sys_sendmsg net/socket.c:2586 [inline]  __se_sys_sendmsg net/socket.c:2584 [inline]  __x64_sys_sendmsg+0x45/0x50 net/socket.c:2584  do_syscall_x64 arch/x86/entry/common.c:50 [inline]  do_syscall_64+0x3b/0x90 arch/x86/entry/common.c:80  entry_SYSCALL_64_after_hwframe+0x6e/0xd8  value changed: 0x000000000000000c -> 0x000000000000000d  Reported by Kernel Concurrency Sanitizer on: CPU: 0 PID: 44814 Comm: systemd-coredum Not tainted 6.4.0-11989-g6843306689af #6 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.16.0-0-gd239552ce722-prebuilt.qemu.org 04/01/2014",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "6.1.55-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.197-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "6.5.6-1",
      "urgency": "not yet assigned"
    }
  }
}