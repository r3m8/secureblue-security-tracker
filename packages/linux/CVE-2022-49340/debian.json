{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  ip_gre: test csum_start instead of transport header  GRE with TUNNEL_CSUM will apply local checksum offload on CHECKSUM_PARTIAL packets.  ipgre_xmit must validate csum_start after an optional skb_pull, else lco_csum may trigger an overflow. The original check was  \tif (csum && skb_checksum_start(skb) < skb->data) \t\treturn -EINVAL;  This had false positives when skb_checksum_start is undefined: when ip_summed is not CHECKSUM_PARTIAL. A discussed refinement was straightforward  \tif (csum && skb->ip_summed == CHECKSUM_PARTIAL && \t    skb_checksum_start(skb) < skb->data) \t\treturn -EINVAL;  But was eventually revised more thoroughly: - restrict the check to the only branch where needed, in an   uncommon GRE path that uses header_ops and calls skb_pull. - test skb_transport_header, which is set along with csum_start   in skb_partial_csum_set in the normal header_ops datapath.  Turns out skbs can arrive in this branch without the transport header set, e.g., through BPF redirection.  Revise the check back to check csum_start directly, and only if CHECKSUM_PARTIAL. Do leave the check in the updated location. Check field regardless of whether TUNNEL_CSUM is configured.",
  "scope": "local",
  "releases": {
    "bookworm": {
      "status": "resolved",
      "repositories": {
        "bookworm": "6.1.148-1",
        "bookworm-security": "6.1.158-1"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye": "5.10.223-1",
        "bullseye-security": "5.10.244-1"
      },
      "fixed_version": "5.10.127-1",
      "urgency": "not yet assigned"
    },
    "forky": {
      "status": "resolved",
      "repositories": {
        "forky": "6.16.12-2"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "sid": {
      "status": "resolved",
      "repositories": {
        "sid": "6.17.7-2"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    },
    "trixie": {
      "status": "resolved",
      "repositories": {
        "trixie": "6.12.43-1",
        "trixie-security": "6.12.48-1"
      },
      "fixed_version": "5.18.5-1",
      "urgency": "not yet assigned"
    }
  }
}