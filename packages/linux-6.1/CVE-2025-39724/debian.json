{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  serial: 8250: fix panic due to PSLVERR  When the PSLVERR_RESP_EN parameter is set to 1, the device generates an error response if an attempt is made to read an empty RBR (Receive Buffer Register) while the FIFO is enabled.  In serial8250_do_startup(), calling serial_port_out(port, UART_LCR, UART_LCR_WLEN8) triggers dw8250_check_lcr(), which invokes dw8250_force_idle() and serial8250_clear_and_reinit_fifos(). The latter function enables the FIFO via serial_out(p, UART_FCR, p->fcr). Execution proceeds to the serial_port_in(port, UART_RX). This satisfies the PSLVERR trigger condition.  When another CPU (e.g., using printk()) is accessing the UART (UART is busy), the current CPU fails the check (value & ~UART_LCR_SPAR) == (lcr & ~UART_LCR_SPAR) in dw8250_check_lcr(), causing it to enter dw8250_force_idle().  Put serial_port_out(port, UART_LCR, UART_LCR_WLEN8) under the port->lock to fix this issue.  Panic backtrace: [    0.442336] Oops - unknown exception [#1] [    0.442343] epc : dw8250_serial_in32+0x1e/0x4a [    0.442351]  ra : serial8250_do_startup+0x2c8/0x88e ... [    0.442416] console_on_rootfs+0x26/0x70",
  "scope": "local",
  "releases": {
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye-security": "6.1.153-1~deb11u1"
      },
      "fixed_version": "6.1.153-1~deb11u1",
      "urgency": "not yet assigned"
    }
  }
}