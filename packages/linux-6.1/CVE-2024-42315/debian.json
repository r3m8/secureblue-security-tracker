{
  "description": "In the Linux kernel, the following vulnerability has been resolved:  exfat: fix potential deadlock on __exfat_get_dentry_set  When accessing a file with more entries than ES_MAX_ENTRY_NUM, the bh-array is allocated in __exfat_get_entry_set. The problem is that the bh-array is allocated with GFP_KERNEL. It does not make sense. In the following cases, a deadlock for sbi->s_lock between the two processes may occur.         CPU0                CPU1        ----                ----   kswapd    balance_pgdat     lock(fs_reclaim)                       exfat_iterate                        lock(&sbi->s_lock)                        exfat_readdir                         exfat_get_uniname_from_ext_entry                          exfat_get_dentry_set                           __exfat_get_dentry_set                            kmalloc_array                             ...                             lock(fs_reclaim)     ...     evict      exfat_evict_inode       lock(&sbi->s_lock)  To fix this, let's allocate bh-array with GFP_NOFS.",
  "scope": "local",
  "releases": {
    "bullseye": {
      "status": "resolved",
      "repositories": {
        "bullseye-security": "6.1.153-1~deb11u1"
      },
      "fixed_version": "6.1.128-1~deb11u1",
      "urgency": "not yet assigned"
    }
  }
}